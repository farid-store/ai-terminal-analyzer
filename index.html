<!doctype html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>MarketHub Dashboard ‚Äî TradingView, Chart, dan Analisis AI</title>

    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <style>
        /* Modern scrollbar for dark theme */
        .custom-scroll::-webkit-scrollbar { width: 8px; height: 8px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }

        /* tradingview sizing helpers */
        .tradingview-widget-container { width: 100%; height: 100%; }
        .tradingview-widget-container__widget { width: 100%; height: 100%; }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-4">

    <header class="mb-6">
        <h1 class="text-3xl font-bold text-yellow-500">MarketHub <span class="text-gray-300">| Trading & AI Analyst</span></h1>
    </header>

    <main class="grid grid-cols-1 gap-6 lg:grid-cols-3 xl:grid-cols-4 h-full" style="grid-template-rows: 60vh 1fr;">

        <div class="lg:col-span-2 xl:col-span-2 bg-gray-800 p-4 rounded-lg flex flex-col h-full">
            <h2 class="text-xl font-semibold mb-4 text-white">Advanced Chart & Symbol Selector</h2>
            
            <div class="flex items-center mb-4 space-x-2">
                <input type="text" id="symbolInput" placeholder="Contoh: OANDA:XAUUSD" class="p-2 rounded bg-gray-700 border border-gray-600 text-white flex-grow">
                <button id="applySymbol" class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded transition duration-200">
                    Tampilkan Simbol
                </button>
            </div>

            <div id="tv-chart-container" class="flex-grow w-full">
                </div>
        </div>

        <div class="lg:col-span-1 xl:col-span-1 bg-gray-800 p-4 rounded-lg flex flex-col h-full">
            <h2 class="text-xl font-semibold mb-4 text-white">ü§ñ Gemini AI Chat (Analisis Instan)</h2>
            <div id="chatWindow" class="custom-scroll flex-grow overflow-y-auto space-y-4 mb-4 p-2 bg-gray-900 rounded-lg">
                <div class="flex justify-start">
                    <div class="bg-gray-700 text-white p-3 rounded-lg max-w-xs">
                        Hai! Kirimkan saya chart (dengan tombol klip) atau tanyakan analisis Anda tentang pasar saat ini.
                    </div>
                </div>
            </div>
            
            <div class="flex space-x-2">
                <label for="imageInput" class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg cursor-pointer transition duration-200 text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M18.375 12.7c-3.1-2.9-7.5-3.3-10.9-1.3C5.9 12.4 5.3 14.1 5 16.1m3.8-2.6c1.1-1.3 2.7-2.1 4.5-2.1s3.4.8 4.5 2.1m-2.2 4.1c.7-1.3 1.1-2.7 1.1-4.2s-.4-2.9-1.1-4.2M21.5 12a9.5 9.5 0 10-19 0 9.5 9.5 0 0019 0z" />
                    </svg>
                    <input type="file" id="imageInput" accept="image/*" class="hidden">
                </label>
                <input type="text" id="messageInput" placeholder="Tulis pesan atau pertanyaan analisis..." class="p-3 rounded-lg bg-gray-700 border border-gray-600 text-white flex-grow" disabled>
                <button id="sendBtn" class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold p-3 rounded-lg transition duration-200" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A5.996 5.996 0 014.788 1.4L18.8 8.4A6.002 6.002 0 0121.6 12a6.002 6.002 0 01-2.8 3.6l-14.012 7.006A5.996 5.996 0 013.27 20.874L6 12z" />
                    </svg>
                </button>
            </div>
        </div>
        
        <div class="lg:col-span-1 xl:col-span-1 flex flex-col space-y-6">
            
            <div class="bg-gray-800 p-4 rounded-lg flex flex-col" style="height: 50%;">
                <h3 class="text-lg font-semibold mb-2">Forex Heatmap</h3>
                <div class="flex-grow">
                    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-forex-heatmap.js" async>
                    {
                        "width": "100%",
                        "height": "100%",
                        "currencies": ["EUR", "USD", "JPY", "GBP", "AUD", "CAD", "NZD", "CHF"],
                        "is</" + "sitemap.xml": false,
                        "colorTheme": "dark",
                        "locale": "id"
                    }
                    </script>
                </div>
            </div>

            <div class="bg-gray-800 p-4 rounded-lg flex flex-col" style="height: 50%;">
                <h3 class="text-lg font-semibold mb-2">Kalender Ekonomi</h3>
                <div class="flex-grow">
                    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-events.js" async>
                    {
                        "colorTheme": "dark",
                        "isDefault": true,
                        "locale": "id",
                        "width": "100%",
                        "height": "100%",
                        "importanceTitle": "Pentingnya"
                    }
                    </script>
                </div>
            </div>
        </div>

        <div class="lg:col-span-3 xl:col-span-4 bg-gray-800 p-4 rounded-lg flex flex-col h-full min-h-[500px]">
            <h2 class="text-xl font-semibold mb-4 text-white">üìà Analisis Harga Historis XAUUSD (2015-2025)</h2>
            
            <div class="flex items-center space-x-4 mb-4">
                <label for="periodSelect" class="text-gray-300">Tampilkan Periode:</label>
                <select id="periodSelect" class="bg-gray-700 text-white border border-gray-600 rounded p-2 text-sm">
                    <option value="all">Keseluruhan (2015-2025)</option>
                    <option value="2025">Tahun 2025</option>
                    <option value="2024">Tahun 2024</option>
                    <option value="2023">Tahun 2023</option>
                    <option value="2022">Tahun 2022</option>
                    <option value="2021">Tahun 2021</option>
                    <option value="2020">Tahun 2020</option>
                    <option value="2019">Tahun 2019</option>
                    <option value="2018">Tahun 2018</option>
                    <option value="2017">Tahun 2017</option>
                    <option value="2016">Tahun 2016</option>
                    <option value="2015">Tahun 2015</option>
                </select>
            </div>

            <div class="flex-grow min-h-[250px] mb-4">
                <canvas id="priceChart"></canvas>
            </div>
            
            <h3 class="text-lg font-semibold text-white mt-4 mb-2 border-t border-gray-700 pt-4">Tabel Analisis Bulanan</h3>
            <div class="custom-scroll overflow-y-auto max-h-[300px]">
                <table class="min-w-full divide-y divide-gray-700">
                    <thead class="sticky top-0 bg-gray-700">
                        <tr>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">Bulan/Tahun</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">Tren</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">Deskripsi</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">Faktor Pemicu</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody" class="divide-y divide-gray-800 text-sm">
                        </tbody>
                </table>
            </div>
        </div>

    </main>

    <script>
        
        /* ---------------------------------------------------- */
        /* --------- SCRIPT CRITICAL: KEAMANAN API --------- */
        /* ---------------------------------------------------- */
        // ‚ùå‚ùå PERINGATAN KRITIS: JANGAN SIMPAN KUNCI API DI SISI KLIEN!
        // Saya mengganti kunci Anda dengan placeholder. Anda HARUS mengimplementasikan proxy server
        // untuk memanggil API Gemini dari sisi server, bukan dari browser.
        const GEMINI_API_KEY = "PLACEHOLDER_KUNCI_API_ANDA_HARUS_DI_BACKEND_SERVER";
        
        const chatWindow = document.getElementById('chatWindow');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const imageInput = document.getElementById('imageInput');

        messageInput.disabled = false;
        sendBtn.disabled = false;
        
        // Cek Keamanan Kunci (Hanya untuk keperluan demonstrasi)
        if (GEMINI_API_KEY === "PLACEHOLDER_KUNCI_API_ANDA_HARUS_DI_BACKEND_SERVER") {
             appendMsg('bot', '<span class="text-red-500 font-bold">‚ö†Ô∏è ERROR KEAMANAN:</span> Kunci API Gemini belum diset. Harap ganti "PLACEHOLDER..." di code dan pindahkan ke backend. Fitur Chat dinonaktifkan.', false, true);
             messageInput.disabled = true;
             sendBtn.disabled = true;
        }

        /* ---------------------------------------------------- */
        /* ------------ TRADINGVIEW CHART LOGIC ------------- */
        /* ---------------------------------------------------- */

        function loadTradingViewWidget(symbol) {
            const container = document.getElementById('tv-chart-container');
            container.innerHTML = ''; // Clear previous widget

            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js';
            script.async = true;
            script.innerHTML = JSON.stringify({
                "autosize": true,
                "symbol": symbol,
                "interval": "D",
                "timezone": "Asia/Jakarta",
                "theme": "dark",
                "style": "1",
                "locale": "id",
                "enable_publishing": false,
                "with_library_header": false,
                "hide_legend": true,
                "allow_symbol_change": true,
                "hotlist": false,
                "calendar": false,
                "support_host": "https://www.tradingview.com"
            });
            container.appendChild(script);
        }

        // Muat Chart Awal
        document.addEventListener('DOMContentLoaded', () => {
            loadTradingViewWidget('OANDA:XAUUSD'); 
        });

        // Event Listener untuk mengganti simbol
        document.getElementById('applySymbol').addEventListener('click', () => {
            const sym = document.getElementById('symbolInput').value.trim() || 'OANDA:XAUUSD';
            loadTradingViewWidget(sym);
        });
        
        
        /* ---------------------------------------------------- */
        /* -------------- GEMINI CHAT LOGIC ------------------- */
        /* ---------------------------------------------------- */

        function appendMsg(sender, content, isImage = false, isError = false) {
            const msgDiv = document.createElement('div');
            msgDiv.className = `flex ${sender === 'user' ? 'justify-end' : 'justify-start'}`;
            
            let htmlContent = '';
            if (isImage) {
                // Untuk menampilkan pratinjau gambar
                htmlContent = `
                    <div class="flex flex-col items-end">
                        <img src="${content.imagePreview}" class="max-w-[200px] h-auto rounded-lg mb-1 border border-gray-600">
                        <span class="text-xs text-gray-400 italic">${content.fileName}</span>
                    </div>
                `;
            } else {
                htmlContent = content; // Teks
            }
            
            const bgColor = isError ? 'bg-red-900 border border-red-700' : (sender === 'user' ? 'bg-yellow-700' : 'bg-gray-700');
            
            const contentDiv = document.createElement('div');
            contentDiv.className = `${bgColor} text-white p-3 rounded-lg max-w-xs transition duration-200`;
            contentDiv.innerHTML = htmlContent;
            
            msgDiv.appendChild(contentDiv);
            chatWindow.appendChild(msgDiv);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        async function fileToGenerativePart(file) {
            const base64Data = await new Promise((resolve) => {
                const reader = new FileReader();
                reader.onloadend = () => resolve(reader.result.split(',')[1]);
                reader.readAsDataURL(file);
            });
            return {
                inlineData: {
                    data: base64Data,
                    mimeType: file.type
                }
            };
        }

        async function callGemini(bodyParts, type) {
            if (messageInput.disabled) return;

            messageInput.disabled = true;
            sendBtn.disabled = true;

            const loadingMsg = document.createElement('div');
            loadingMsg.className = 'flex justify-start';
            loadingMsg.innerHTML = '<div class="bg-gray-700 text-white p-3 rounded-lg"><span class="animate-pulse">AI sedang berpikir...</span></div>';
            chatWindow.appendChild(loadingMsg);
            chatWindow.scrollTop = chatWindow.scrollHeight;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: bodyParts }],
                        config: { 
                            systemInstruction: "Anda adalah analis pasar dan keuangan profesional. Berikan analisis teknikal dan fundamental yang ringkas dan lugas dalam Bahasa Indonesia.",
                            temperature: 0.2 
                        }
                    })
                });

                chatWindow.removeChild(loadingMsg);

                if (!response.ok) {
                    throw new Error(`Kode Status ${response.status}: Tidak dapat menghubungi API Gemini. Cek kunci API dan jaringan.`);
                }

                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Maaf, saya gagal memproses permintaan Anda.";
                
                // Gunakan format markdown untuk balasan bot
                const formattedText = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                                          .replace(/\n/g, '<br>');

                appendMsg('bot', formattedText);

            } catch (error) {
                chatWindow.removeChild(loadingMsg);
                appendMsg('bot', `<span class="text-red-400 font-semibold">‚ùå Error: ${error.message}</span>`, false, true);
            } finally {
                messageInput.disabled = false;
                sendBtn.disabled = false;
                messageInput.focus();
            }
        }

        function handleSend() {
            const message = messageInput.value.trim();
            if (message === '') return;

            appendMsg('user', message); 
            messageInput.value = '';

            const bodyParts = [{ text: message }];
            callGemini(bodyParts, 'text');
        }

        async function handleImageFileChange() {
            const file = imageInput.files[0];
            const message = messageInput.value.trim();
            
            if (!file) return;

            const imagePreview = URL.createObjectURL(file);
            appendMsg('user', { imagePreview, fileName: file.name }, true);
            
            try {
                 var imagePart = await fileToGenerativePart(file);
            } catch (error) {
                 appendMsg('bot', `<span class="text-red-400 font-semibold">‚ùå Error saat membaca file: ${error.message}</span>`);
                 imageInput.value = ''; 
                 return;
            }

            const bodyParts = [imagePart];
            if (message) {
                bodyParts.push({ text: message });
            } else {
                bodyParts.push({ text: "Analisis gambar chart ini. Berikan analisis teknikalnya." });
            }

            messageInput.value = '';
            imageInput.value = ''; 

            callGemini(bodyParts, 'multimodal');
        }


        /* ======== Event Listeners yang Diperbarui ======== */

        sendBtn.addEventListener('click', handleSend);
        messageInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !messageInput.disabled) handleSend();
        });

        imageInput.addEventListener('change', handleImageFileChange);
        
        
        /* ---------------------------------------------------- */
        /* ------------ HISTORICAL DATA LOGIC (BARU) ---------- */
        /* ---------------------------------------------------- */

        const rawData = [
            // --- Periode 2015 (Pasca The Fed Tapering) ---
            { monthYear: "Jan 2015", trend: "Ranging", desc: "Konsolidasi di tengah penguatan Dolar AS.", factor: "Kekuatan Dolar AS pasca berakhirnya Quantitative Easing (QE) The Fed." },
            { monthYear: "Feb 2015", trend: "Downtrend", desc: "Penurunan tajam, momentum bearish kuat.", factor: "Ekspektasi kenaikan suku bunga AS (Rate Hike)." },
            { monthYear: "Mar 2015", trend: "Ranging", desc: "Sideways/konsolidasi di area support.", factor: "Pasar mencerna data ekonomi AS yang beragam." },
            { monthYear: "Apr 2015", trend: "Uptrend", desc: "Rebound teknikal yang kuat.", factor: "Kelemahan sementara pada DXY (Indeks Dolar AS)." },
            { monthYear: "Mei 2015", trend: "Downtrend", desc: "Tren bearish dominan, gagal menembus resistance.", factor: "Pemulihan ekonomi AS & inflasi yang tetap rendah." },
            { monthYear: "Jun 2015", trend: "Downtrend", desc: "Penurunan berkelanjutan menuju level terendah.", factor: "Krisis utang Yunani kembali memicu ketidakpastian Eurozone." },
            { monthYear: "Jul 2015", trend: "Downtrend tajam", desc: "Penurunan drastis, terendah multi-tahun.", factor: "Kepastian kenaikan suku bunga Fed mendekat." },
            { monthYear: "Agu 2015", trend: "Ranging", desc: "Rebound & konsolidasi dari level rendah.", factor: "Devaluasi Yuan Tiongkok yang memicu volatilitas pasar." },
            { monthYear: "Sep 2015", trend: "Downtrend", desc: "Tekanan jual kembali dominan.", factor: "The Fed menunda kenaikan suku bunga pertamanya." },
            { monthYear: "Okt 2015", trend: "Uptrend", desc: "Kenaikan moderat dari bottom.", factor: "Data non-farm payroll (NFP) AS yang lemah." },
            { monthYear: "Nov 2015", trend: "Downtrend", desc: "Turun tajam, tembus support krusial.", factor: "Dolar AS menguat tajam, Fed bersiap naikkan suku bunga." },
            { monthYear: "Des 2015", trend: "Ranging", desc: "Sideways di area bawah, menunggu Rate Hike.", factor: "**The Fed menaikkan suku bunga untuk pertama kali (Des 2015).**" },
            // --- Periode 2016 (Pasca Rate Hike Pertama) ---
            { monthYear: "Jan 2016", trend: "Uptrend kuat", desc: "Rebound masif dari level terendah.", factor: "Kekacauan pasar saham global (khususnya Tiongkok) & harga minyak jatuh." },
            { monthYear: "Feb 2016", trend: "Uptrend", desc: "Momentum bullish berlanjut.", factor: "Peningkatan permintaan safe haven." },
            { monthYear: "Mar 2016", trend: "Ranging", desc: "Konsolidasi di area tinggi.", factor: "The Fed bersikap dovish (perlambatan kenaikan suku bunga)." },
            { monthYear: "Apr 2016", trend: "Downtrend", desc: "Koreksi setelah kenaikan panjang.", factor: "Kekuatan Dolar AS sementara." },
            { monthYear: "Mei 2016", trend: "Downtrend", desc: "Penurunan harga yang stabil.", factor: "Ekspektasi kenaikan suku bunga Fed (Rate Hike kedua)." },
            { monthYear: "Jun 2016", trend: "Uptrend tajam", desc: "Lonjakan harga yang sangat kuat.", factor: "**Keputusan Brexit (Inggris keluar dari Uni Eropa).**" },
            { monthYear: "Jul 2016", trend: "Ranging", desc: "Konsolidasi pasca Brexit, volatilitas tinggi.", factor: "Intervensi bank sentral pasca Brexit." },
            { monthYear: "Agu 2016", trend: "Downtrend", desc: "Koreksi wajar setelah lonjakan Juni.", factor: "Data ekonomi AS yang membaik." },
            { monthYear: "Sep 2016", trend: "Ranging", desc: "Pergerakan mendatar, tidak ada arah jelas.", factor: "The Fed tetap menahan suku bunga." },
            { monthYear: "Okt 2016", trend: "Downtrend", desc: "Penurunan yang stabil.", factor: "Penguatan Dolar AS menjelang pemilu AS." },
            { monthYear: "Nov 2016", trend: "Downtrend tajam", desc: "Penjualan besar-besaran pasca pemilu AS.", factor: "**Kemenangan Donald Trump (Janji stimulus fiskal besar).**" },
            { monthYear: "Des 2016", trend: "Downtrend", desc: "Tekanan jual berlanjut hingga akhir tahun.", factor: "**The Fed menaikkan suku bunga (Rate Hike kedua).**" },
            // --- Periode 2017 (Normalisasi Fed) ---
            { monthYear: "Jan 2017", trend: "Uptrend", desc: "Rebound awal tahun dari level rendah.", factor: "Melemahnya USD pasca kenaikan suku bunga." },
            { monthYear: "Feb 2017", trend: "Uptrend", desc: "Kenaikan stabil.", factor: "Ketidakpastian kebijakan Trump." },
            { monthYear: "Mar 2017", trend: "Uptrend", desc: "Mencapai puncak kuartalan.", factor: "**The Fed menaikkan suku bunga (Rate Hike ketiga).**" },
            { monthYear: "Apr 2017", trend: "Ranging", desc: "Konsolidasi di area atas.", factor: "Ketegangan geopolitik AS-Korea Utara." },
            { monthYear: "Mei 2017", trend: "Downtrend", desc: "Koreksi wajar.", factor: "Penguatan Dolar AS." },
            { monthYear: "Jun 2017", trend: "Ranging", desc: "Sideways di area support.", factor: "**The Fed menaikkan suku bunga (Rate Hike keempat).**" },
            { monthYear: "Jul 2017", trend: "Uptrend", desc: "Rebound yang kuat.", factor: "Melemahnya USD secara umum." },
            { monthYear: "Agu 2017", trend: "Uptrend", desc: "Kenaikan stabil.", factor: "Ketegangan geopolitik (Korea Utara & Venezuela)." },
            { monthYear: "Sep 2017", trend: "Downtrend", desc: "Koreksi yang signifikan.", factor: "The Fed mengumumkan pengurangan neraca." },
            { monthYear: "Okt 2017", trend: "Ranging", desc: "Fluktuasi kecil.", factor: "Menunggu kebijakan The Fed berikutnya." },
            { monthYear: "Nov 2017", trend: "Downtrend", desc: "Penurunan stabil.", factor: "Penguatan Dolar AS." },
            { monthYear: "Des 2017", trend: "Uptrend", desc: "Rally mini akhir tahun.", factor: "**The Fed menaikkan suku bunga (Rate Hike kelima).**" },
            // --- Periode 2018 (Perang Dagang & Kenaikan Suku Bunga) ---
            { monthYear: "Jan 2018", trend: "Uptrend", desc: "Bullish awal tahun, momentum kuat.", factor: "Kelemahan DXY & awal ketegangan perdagangan." },
            { monthYear: "Feb 2018", trend: "Downtrend", desc: "Koreksi tajam.", factor: "Kekuatan Dolar AS kembali." },
            { monthYear: "Mar 2018", trend: "Ranging", desc: "Sideways/konsolidasi.", factor: "**The Fed menaikkan suku bunga (Rate Hike keenam).**" },
            { monthYear: "Apr 2018", trend: "Downtrend", desc: "Tekanan jual dominan.", factor: "Imbal hasil obligasi AS naik." },
            { monthYear: "Mei 2018", trend: "Downtrend", desc: "Bearish berkelanjutan.", factor: "Penguatan Dolar AS karena Perang Dagang AS-Tiongkok." },
            { monthYear: "Jun 2018", trend: "Downtrend", desc: "Turun ke level terendah.", factor: "**The Fed menaikkan suku bunga (Rate Hike ketujuh).**" },
            { monthYear: "Jul 2018", trend: "Downtrend", desc: "Penurunan yang stabil.", factor: "Dolar AS sebagai safe haven." },
            { monthYear: "Agu 2018", trend: "Ranging", desc: "Mulai membentuk base di area bawah.", factor: "Investor mencerna kebijakan perdagangan AS." },
            { monthYear: "Sep 2018", trend: "Ranging", desc: "Volatilitas rendah.", factor: "Tidak ada katalis besar." },
            { monthYear: "Okt 2018", trend: "Uptrend", desc: "Rebound besar dari support.", factor: "Koreksi pasar saham global." },
            { monthYear: "Nov 2018", trend: "Ranging", desc: "Sideways di level tengah.", factor: "Menunggu pertemuan The Fed berikutnya." },
            { monthYear: "Des 2018", trend: "Uptrend kuat", desc: "Rally masif akhir tahun.", factor: "**The Fed menaikkan suku bunga (Rate Hike kedelapan) dan pasar saham AS anjlok.**" },
            // --- Periode 2019 (Fed Pivot Dovish) ---
            { monthYear: "Jan 2019", trend: "Ranging", desc: "Konsolidasi pasca rally besar.", factor: "The Fed bersikap dovish & mengisyaratkan pause rate hike." },
            { monthYear: "Feb 2019", trend: "Downtrend", desc: "Koreksi tajam.", factor: "Kekuatan Dolar AS sementara." },
            { monthYear: "Mar 2019", trend: "Ranging", desc: "Sideways, mencari arah.", factor: "Tidak ada data besar." },
            { monthYear: "Apr 2019", trend: "Ranging", desc: "Fluktuasi kecil.", factor: "Ketidakpastian negosiasi Brexit." },
            { monthYear: "Mei 2019", trend: "Ranging", desc: "Konsolidasi di area support.", factor: "Peningkatan ketegangan perdagangan AS-Tiongkok." },
            { monthYear: "Jun 2019", trend: "Uptrend tajam", desc: "Breakout kuat, momentum bullish.", factor: "The Fed mengisyaratkan pemotongan suku bunga (Rate Cut)." },
            { monthYear: "Jul 2019", trend: "Uptrend", desc: "Kenaikan stabil.", factor: "**The Fed memangkas suku bunga (Rate Cut pertama).**" },
            { monthYear: "Agu 2019", trend: "Uptrend kuat", desc: "Lonjakan besar menuju area 1550.", factor: "Ketegangan perdagangan AS-Tiongkok meningkat tajam." },
            { monthYear: "Sep 2019", trend: "Downtrend", desc: "Koreksi wajar pasca puncak.", factor: "**The Fed memangkas suku bunga (Rate Cut kedua).**" },
            { monthYear: "Okt 2019", trend: "Ranging", desc: "Sideways di level tinggi.", factor: "Mulai ada harapan damai dagang AS-Tiongkok." },
            { monthYear: "Nov 2019", trend: "Downtrend", desc: "Penurunan dari level tinggi.", factor: "**The Fed memangkas suku bunga (Rate Cut ketiga).**" },
            { monthYear: "Des 2019", trend: "Uptrend", desc: "Rally mini akhir tahun.", factor: "Ekspektasi inflasi, perjanjian damai dagang fase 1." },
            // --- Periode 2020 (Pandemi) hingga Okt 2025 (Menggunakan data Anda) ---
            { monthYear: "Jan 2020", trend: "Uptrend moderat", desc: "Emas menguat stabil sejak awal tahun.", factor: "Ketegangan AS‚ÄìIran & penyebasan awal COVID-19 di Tiongkok." },
            { monthYear: "Feb 2020", trend: "Uptrend kuat", desc: "Harga melonjak tajam ke area 1.680‚Äì1.700.", factor: "COVID-19 mulai menyebar global, minat safe haven naik." },
            { monthYear: "Mar 2020", trend: "Volatil (Crash ‚Üí Rebound)", desc: "Awalnya turun drastis karena panic selling, lalu pulih.", factor: "Crash likuiditas global (Maret 2020), lalu intervensi The Fed." },
            { monthYear: "Apr 2020", trend: "Uptrend tajam", desc: "Rebound kuat menuju area 1.700‚Äì1750.", factor: "Stimulus besar-besaran & suku bunga mendekati 0%." },
            { monthYear: "Mei 2020", trend: "Uptrend stabil", desc: "Harga bertahan tinggi, permintaan investasi naik.", factor: "The Fed lanjutkan QE, inflasi jangka panjang diantisipasi." },
            { monthYear: "Jun 2020", trend: "Uptrend kuat", desc: "Breakout menuju area 1.780‚Äì1.800.", factor: "DXY melemah, ekspektasi stimulus tambahan." },
            { monthYear: "Jul 2020", trend: "Uptrend kuat", desc: "Lonjakan besar akibat stimulus pandemi global.", factor: "Stimulus masif dari The Fed & paket bantuan COVID-19." },
            { monthYear: "Agu 2020", trend: "Uptrend ‚Üí Koreksi", desc: "Mencapai puncak historis, lalu profit taking.", factor: "Euforia safe haven puncak, lalu profit taking." },
            { monthYear: "Sep 2020", trend: "Downtrend", desc: "Tekanan jual pasca puncak Agustus.", factor: "Penguatan USD & ekspektasi pemulihan ekonomi." },
            { monthYear: "Okt 2020", trend: "Ranging", desc: "Konsolidasi di area 1880‚Äì1920.", factor: "Menunggu hasil pemilu AS 2020." },
            { monthYear: "Nov 2020", trend: "Downtrend", desc: "Penurunan akibat optimisme vaksin COVID-19.", factor: "Pengumuman vaksin Pfizer-BioNTech." },
            { monthYear: "Des 2020", trend: "Ranging ‚Üí Uptrend", desc: "Mulai pulih menjelang akhir tahun.", factor: "Paket stimulus tambahan AS disetujui." },
            { monthYear: "Jan 2021", trend: "Uptrend ‚Üí Downtrend", desc: "Lonjakan awal tahun, lalu terkoreksi.", factor: "Harapan stimulus Biden, lalu yield US naik." },
            { monthYear: "Feb 2021", trend: "Downtrend", desc: "Yield US naik, tekanan jual tinggi.", factor: "Lonjakan yield Treasury 10 tahun." },
            { monthYear: "Mar 2021", trend: "Ranging ‚Üí Downtrend", desc: "Volatilitas tinggi, gagal rebound.", factor: "Dolar menguat akibat ekspektasi tapering." },
            { monthYear: "Apr 2021", trend: "Ranging", desc: "Pasar mulai stabil di area bawah.", factor: "Tidak ada data besar; konsolidasi." },
            { monthYear: "Mei 2021", trend: "Uptrend kuat", desc: "Rebound besar dari area support.", factor: "Inflasi AS naik tajam ‚Üí dorong permintaan emas." },
            { monthYear: "Jun 2021", trend: "Downtrend tajam", desc: "Penurunan cepat pasca FOMC hawkish.", factor: "FOMC sinyalkan kenaikan suku bunga lebih cepat." },
            { monthYear: "Jul 2021", trend: "Ranging", desc: "Pergerakan datar, volatilitas rendah.", factor: "Pasar menunggu sinyal Fed berikutnya." },
            { monthYear: "Agu 2021", trend: "Ranging", desc: "Tidak ada arah jelas, harga berosilasi.", factor: "Data ekonomi campuran AS." },
            { monthYear: "Sep 2021", trend: "Downtrend", desc: "Tekanan jual dominan, lower low terbentuk.", factor: "Dolar menguat, ekspektasi tapering tinggi." },
            { monthYear: "Okt 2021", trend: "Uptrend", desc: "Reversal naik dari support bawah.", factor: "Inflasi tinggi picu minat safe haven." },
            { monthYear: "Nov 2021", trend: "Ranging", desc: "Konsolidasi di area tengah.", factor: "Menanti kepastian kebijakan tapering Fed." },
            { monthYear: "Des 2021", trend: "Ranging", desc: "Fluktuasi kecil menjelang akhir tahun.", factor: "Volume pasar rendah, libur akhir tahun." },
            { monthYear: "Jan 2022", trend: "Ranging ‚Üí Uptrend", desc: "Mulai muncul tekanan beli signifikan.", factor: "Ketegangan geopolitik Rusia‚ÄìUkraina meningkat." },
            { monthYear: "Feb 2022", trend: "Uptrend kuat", desc: "Lonjakan akibat geopolitik (Russia‚ÄìUkraine).", factor: "Invasi Rusia ke Ukraina (Feb 24)." },
            { monthYear: "Mar 2022", trend: "Downtrend tajam", desc: "Koreksi kuat pasca lonjakan ekstrem.", factor: "Ekspektasi kenaikan suku bunga Fed." },
            { monthYear: "Apr 2022", trend: "Ranging ‚Üí Downtrend", desc: "Harga gagal menembus resistance, berbalik turun.", factor: "The Fed mulai agresif (kebijakan hawkish)." },
            { monthYear: "Mei 2022", trend: "Downtrend", desc: "Bearish stabil dengan lower low.", factor: "Inflasi tinggi, Fed tingkatkan suku bunga." },
            { monthYear: "Jun 2022", trend: "Downtrend", desc: "Tekanan jual masih kuat.", factor: "USD terus menguat, DXY tembus 105." },
            { monthYear: "Jul 2022", trend: "Ranging", desc: "Konsolidasi membentuk base.", factor: "Ekspektasi inflasi mulai turun." },
            { monthYear: "Agu 2022", trend: "Uptrend singkat", desc: "Rebound teknikal dari support.", factor: "DXY melemah sementara." },
            { monthYear: "Sep 2022", trend: "Downtrend", desc: "Turun kembali setelah rally pendek.", factor: "Fed naikkan suku bunga 75 bps lagi." },
            { monthYear: "Okt 2022", trend: "Ranging", desc: "Area bottom mulai terbentuk.", factor: "Investor mulai akumulasi emas kembali." },
            { monthYear: "Nov 2022", trend: "Uptrend", desc: "Breakout resistance besar, momentum naik.", factor: "CPI AS turun ‚Üí ekspektasi Fed melunak." },
            { monthYear: "Des 2022", trend: "Uptrend", desc: "Tren naik stabil hingga akhir tahun.", factor: "Optimisme soft landing." },
            { monthYear: "Jan 2023", trend: "Uptrend", desc: "Higher high konsisten, tren bullish kuat.", factor: "DXY melemah, ekspektasi Fed akan pivot." },
            { monthYear: "Feb 2023", trend: "Downtrend", desc: "Koreksi dari puncak.", factor: "Data inflasi AS kembali tinggi." },
            { monthYear: "Mar 2023", trend: "Uptrend", desc: "Rebound kuat pasca koreksi.", factor: "Krisis perbankan AS (Silicon Valley Bank)." },
            { monthYear: "Apr 2023", trend: "Uptrend ‚Üí Ranging", desc: "Kenaikan melambat di resistance.", factor: "Fed jaga suku bunga tetap tinggi." },
            { monthYear: "Mei 2023", trend: "Downtrend", desc: "Tekanan jual mulai meningkat.", factor: "Debt ceiling AS & profit taking." },
            { monthYear: "Jun 2023", trend: "Ranging", desc: "Harga mendatar.", factor: "Tidak ada katalis besar." },
            { monthYear: "Jul 2023", trend: "Ranging", desc: "Volatilitas rendah.", factor: "Libur musim panas, volume tipis." },
            { monthYear: "Agu 2023", trend: "Ranging ‚Üí Uptrend awal", desc: "Mulai muncul higher low.", factor: "Data inflasi melunak." },
            { monthYear: "Sep 2023", trend: "Uptrend", desc: "Tren bullish stabil.", factor: "Fed sinyalkan akhir siklus kenaikan suku bunga." },
            { monthYear: "Okt 2023", trend: "Uptrend kuat", desc: "Breakout area resistance utama.", factor: "Konflik Hamas‚ÄìIsrael (Okt 7)." },
            { monthYear: "Nov 2023", trend: "Uptrend", desc: "Momentum bullish masih dominan.", factor: "Ketegangan Timur Tengah berlanjut." },
            { monthYear: "Des 2023", trend: "Ranging", desc: "Konsolidasi di area puncak.", factor: "Pasar tenang jelang akhir tahun." },
            { monthYear: "Jan 2024", trend: "Ranging ‚Üí Downtrend", desc: "Awal tahun terjadi koreksi besar.", factor: "DXY rebound & data tenaga kerja kuat." },
            { monthYear: "Feb 2024", trend: "Downtrend", desc: "Penurunan konsisten, candle bearish besar.", factor: "CPI tinggi ‚Üí Fed hawkish kembali." },
            { monthYear: "Mar 2024", trend: "Ranging", desc: "Pasar tenang setelah koreksi.", factor: "Tidak ada data besar." },
            { monthYear: "Apr 2024", trend: "Uptrend kuat", desc: "Breakout dari konsolidasi, kenaikan signifikan.", factor: "Dolar melemah, data inflasi turun." },
            { monthYear: "Mei 2024", trend: "Uptrend", desc: "Tren naik masih terjaga.", factor: "Spekulasi pemotongan suku bunga Fed." },
            { monthYear: "Jun 2024", trend: "Ranging", desc: "Pergerakan mendatar di level tinggi.", factor: "Investor tunggu keputusan FOMC." },
            { monthYear: "Jul 2024", trend: "Downtrend", desc: "Koreksi dari area atas.", factor: "DXY menguat kembali." },
            { monthYear: "Aug 2024", trend: "Downtrend", desc: "Lanjutan tekanan jual.", factor: "PMI dan CPI positif di AS." },
            { monthYear: "Sep 2024", trend: "Ranging ‚Üí Uptrend", desc: "Reversal mulai terbentuk.", factor: "Ekspektasi dovish Fed." },
            { monthYear: "Okt 2024", trend: "Uptrend", desc: "Kenaikan stabil.", factor: "Inflasi global menurun." },
            { monthYear: "Nov 2024", trend: "Ranging", desc: "Konsolidasi di area atas.", factor: "Menunggu hasil pemilu AS." },
            { monthYear: "Dec 2024", trend: "Uptrend", desc: "Bullish continuation menjelang akhir tahun.", factor: "Euforia pasca pemilu AS." },
            { monthYear: "Jan 2025", trend: "Uptrend", desc: "Harga menembus resistance lama.", factor: "Fed mulai potong suku bunga." },
            { monthYear: "Feb 2025", trend: "Ranging", desc: "Sideways di puncak.", factor: "Tidak ada katalis besar." },
            { monthYear: "Mar 2025", trend: "Downtrend", desc: "Koreksi wajar setelah rally panjang.", factor: "USD rebound teknikal." },
            { monthYear: "Apr 2025", trend: "Downtrend", desc: "Tekanan jual meningkat.", factor: "Data inflasi naik kembali." },
            { monthYear: "Mei 2025", trend: "Ranging", desc: "Konsolidasi setelah drop.", factor: "Pasar menunggu arah kebijakan baru Fed." },
            { monthYear: "Jun 2025", trend: "Ranging ‚Üí Uptrend", desc: "Tanda reversal bullish awal.", factor: "Data CPI menurun lagi." },
            { monthYear: "Jul 2025", trend: "Uptrend", desc: "Momentum naik mulai kuat lagi.", factor: "Spekulasi pemotongan lanjutan suku bunga." },
            { monthYear: "Agu 2025", trend: "Uptrend", desc: "Bullish stabil dengan higher low.", factor: "USD melemah, risk-off meningkat." },
            { monthYear: "Sep 2025", trend: "Ranging", desc: "Mulai datar menjelang Q4.", factor: "Tidak ada event besar." },
            { monthYear: "Okt 2025", trend: "Ranging ‚Üí Uptrend", desc: "Ada potensi kenaikan lanjutan ke akhir tahun.", factor: "Ketegangan geopolitik baru di Timur Tengah." }
        ];

        const priceData = [
            // --- Periode 2015 ---
            { month: 'Jan', year: 2015, high: 1307.387, low: 1201.766 },
            { month: 'Feb', year: 2015, high: 1295.277, low: 1195.424 },
            { month: 'Mar', year: 2015, high: 1224.239, low: 1142.345 },
            { month: 'Apr', year: 2015, high: 1224.591, low: 1178.614 },
            { month: 'Mei', year: 2015, high: 1232.067, low: 1170.925 },
            { month: 'Jun', year: 2015, high: 1204.31, low: 1172.935 },
            { month: 'Jul', year: 2015, high: 1165.738, low: 1076.62 },
            { month: 'Agu', year: 2015, high: 1131.742, low: 1079.176 },
            { month: 'Sep', year: 2015, high: 1156.401, low: 1104.997 },
            { month: 'Okt', year: 2015, high: 1184.225, low: 1100.868 },
            { month: 'Nov', year: 2015, high: 1150.311, low: 1064.954 },
            { month: 'Des', year: 2015, high: 1087.97, low: 1046.208 },
            // --- Periode 2016 ---
            { month: 'Jan', year: 2016, high: 1127.915, low: 1070.781 },
            { month: 'Feb', year: 2016, high: 1263.951, low: 1092.793 },
            { month: 'Mar', year: 2016, high: 1284.156, low: 1206.197 },
            { month: 'Apr', year: 2016, high: 1297.042, low: 1210.027 },
            { month: 'Mei', year: 2016, high: 1300.732, low: 1209.615 },
            { month: 'Jun', year: 2016, high: 1358.97, low: 1201.037 },
            { month: 'Jul', year: 2016, high: 1375.02, low: 1308.205 },
            { month: 'Agu', year: 2016, high: 1367.62, low: 1310.875 },
            { month: 'Sep', year: 2016, high: 1343.344, low: 1302.26 },
            { month: 'Okt', year: 2016, high: 1337.894, low: 1241.055 },
            { month: 'Nov', year: 2016, high: 1304.538, low: 1170.999 },
            { month: 'Des', year: 2016, high: 1180.767, low: 1121.282 },
            // --- Periode 2017 ---
            { month: 'Jan', year: 2017, high: 1221.782, low: 1139.75 },
            { month: 'Feb', year: 2017, high: 1263.268, low: 1209.083 },
            { month: 'Mar', year: 2017, high: 1269.467, low: 1205.578 },
            { month: 'Apr', year: 2017, high: 1295.631, low: 1239.544 },
            { month: 'Mei', year: 2017, high: 1272.76, low: 1214.39 },
            { month: 'Jun', year: 2017, high: 1295.731, low: 1230.134 },
            { month: 'Jul', year: 2017, high: 1264.44, low: 1204.654 },
            { month: 'Agu', year: 2017, high: 1317.02, low: 1251.107 },
            { month: 'Sep', year: 2017, high: 1357.755, low: 1260.675 },
            { month: 'Okt', year: 2017, high: 1306.075, low: 1260.368 },
            { month: 'Nov', year: 2017, high: 1296.38, low: 1263.743 },
            { month: 'Des', year: 2017, high: 1299.165, low: 1236.787 },
            // --- Periode 2018 ---
            { month: 'Jan', year: 2018, high: 1366.195, low: 1308.267 },
            { month: 'Feb', year: 2018, high: 1361.642, low: 1307.747 },
            { month: 'Mar', year: 2018, high: 1357.877, low: 1305.105 },
            { month: 'Apr', year: 2018, high: 1365.17, low: 1304.57 },
            { month: 'Mei', year: 2018, high: 1324.966, low: 1284.116 },
            { month: 'Jun', year: 2018, high: 1309.847, low: 1243.618 },
            { month: 'Jul', year: 2018, high: 1265.918, low: 1211.961 },
            { month: 'Agu', year: 2018, high: 1220.738, low: 1160.038 },
            { month: 'Sep', year: 2018, high: 1215.111, low: 1184.148 },
            { month: 'Okt', year: 2018, high: 1243.518, low: 1183.05 },
            { month: 'Nov', year: 2018, high: 1249.773, low: 1200.738 },
            { month: 'Des', year: 2018, high: 1285.498, low: 1219.866 },
            // --- Periode 2019 ---
            { month: 'Jan', year: 2019, high: 1317.844, low: 1276.104 },
            { month: 'Feb', year: 2019, high: 1346.746, low: 1280.975 },
            { month: 'Mar', year: 2019, high: 1324.464, low: 1281.332 },
            { month: 'Apr', year: 2019, high: 1310.279, low: 1266.386 },
            { month: 'Mei', year: 2019, high: 1303.407, low: 1266.696 },
            { month: 'Jun', year: 2019, high: 1441.761, low: 1270.751 },
            { month: 'Jul', year: 2019, high: 1453.076, low: 1381.821 },
            { month: 'Agu', year: 2019, high: 1555.708, low: 1451.916 },
            { month: 'Sep', year: 2019, high: 1557.067, low: 1459.186 },
            { month: 'Okt', year: 2019, high: 1519.814, low: 1457.551 },
            { month: 'Nov', year: 2019, high: 1514.88, low: 1445.672 },
            { month: 'Des', year: 2019, high: 1525.185, low: 1458.556 },
            // --- Periode 2020 - Okt 2025 (Verifikasi data Anda) ---
            { month: 'Jan', year: 2020, high: 1611.365, low: 1517.172 },
            { month: 'Feb', year: 2020, high: 1689.213, low: 1547.479 },
            { month: 'Mar', year: 2020, high: 1703.179, low: 1451.281 },
            { month: 'Apr', year: 2020, high: 1746.579, low: 1571.348 },
            { month: 'Mei', year: 2020, high: 1764.715, low: 1670.131 },
            { month: 'Jun', year: 2020, high: 1785.729, low: 1670.51 },
            { month: 'Jul', year: 2020, high: 1982.318, low: 1757.464 },
            { month: 'Agu', year: 2020, high: 2073.682, low: 1863.593 },
            { month: 'Sep', year: 2020, high: 1992.297, low: 1848.076 },
            { month: 'Okt', year: 2020, high: 1933.178, low: 1859.815 },
            { month: 'Nov', year: 2020, high: 1965.419, low: 1764.16 },
            { month: 'Des', year: 2020, high: 1906.667, low: 1776.74 },
            { month: 'Jan', year: 2021, high: 1959.29, low: 1802.438 },
            { month: 'Feb', year: 2021, high: 1871.716, low: 1717.03 },
            { month: 'Mar', year: 2021, high: 1759.715, low: 1676.627 },
            { month: 'Apr', year: 2021, high: 1797.756, low: 1705.761 },
            { month: 'Mei', year: 2021, high: 1912.616, low: 1766.046 },
            { month: 'Jun', year: 2021, high: 1916.446, low: 1750.621 },
            { month: 'Jul', year: 2021, high: 1834.039, low: 1765.633 },
            { month: 'Agu', year: 2021, high: 1831.657, low: 1686.784 },
            { month: 'Sep', year: 2021, high: 1833.859, low: 1721.571 },
            { month: 'Okt', year: 2021, high: 1813.56, low: 1745.822 },
            { month: 'Nov', year: 2021, high: 1877.067, low: 1758.534 },
            { month: 'Des', year: 2021, high: 1828.722, low: 1753.053 },
            { month: 'Jan', year: 2022, high: 1853.785, low: 1779.895 },
            { month: 'Feb', year: 2022, high: 1974.331, low: 1788.521 },
            { month: 'Mar', year: 2022, high: 2070.292, low: 1889.783 },
            { month: 'Apr', year: 2022, high: 1998.024, low: 1871.981 },
            { month: 'Mei', year: 2022, high: 1909.551, low: 1786.381 },
            { month: 'Jun', year: 2022, high: 1878.832, low: 1802.627 },
            { month: 'Jul', year: 2022, high: 1814.091, low: 1680.811 },
            { month: 'Agu', year: 2022, high: 1807.831, low: 1705.48 },
            { month: 'Sep', year: 2022, high: 1735.081, low: 1614.427 },
            { month: 'Okt', year: 2022, high: 1729.469, low: 1616.886 },
            { month: 'Nov', year: 2022, high: 1786.472, low: 1616.624 },
            { month: 'Des', year: 2022, high: 1832.979, low: 1765.756 },
            { month: 'Jan', year: 2023, high: 1949.116, low: 1823.998 },
            { month: 'Feb', year: 2023, high: 1959.639, low: 1804.362 },
            { month: 'Mar', year: 2023, high: 2009.668, low: 1809.372 },
            { month: 'Apr', year: 2023, high: 2048.597, low: 1949.542 },
            { month: 'Mei', year: 2023, high: 2079.817, low: 1932.042 },
            { month: 'Jun', year: 2023, high: 1983.332, low: 1892.839 },
            { month: 'Jul', year: 2023, high: 1987.421, low: 1902.568 },
            { month: 'Agu', year: 2023, high: 1964.628, low: 1884.547 },
            { month: 'Sep', year: 2023, high: 1952.331, low: 1846.282 },
            { month: 'Okt', year: 2023, high: 2009.327, low: 1810.402 },
            { month: 'Nov', year: 2023, high: 2052.03, low: 1921.394 },
            { month: 'Des', year: 2023, high: 2144.46, low: 1973.033 },
            { month: 'Jan', year: 2024, high: 2078.877, low: 2001.742 },
            { month: 'Feb', year: 2024, high: 2065.458, low: 1984.121 },
            { month: 'Mar', year: 2024, high: 2247.34, low: 2039.039 },
            { month: 'Apr', year: 2024, high: 2431.527, low: 2228.472 },
            { month: 'Mei', year: 2024, high: 2450.026, low: 2277.089 },
            { month: 'Jun', year: 2024, high: 2387.702, low: 2286.723 },
            { month: 'Jul', year: 2024, high: 2483.739, low: 2318.438 },
            { month: 'Agu', year: 2024, high: 2531.668, low: 2364.267 },
            { month: 'Sep', year: 2024, high: 2685.611, low: 2471.826 },
            { month: 'Okt', year: 2024, high: 2790.075, low: 2602.178 },
            { month: 'Nov', year: 2024, high: 2762.254, low: 2536.755 },
            { month: 'Des', year: 2024, high: 2726.206, low: 2583.389 },
            { month: 'Jan', year: 2025, high: 2817.244, low: 2614.419 },
            { month: 'Feb', year: 2025, high: 2956.229, low: 2772.151 },
            { month: 'Mar', year: 2025, high: 3128.165, low: 2858.83 },
            { month: 'Apr', year: 2025, high: 3500.033, low: 2956.374 },
            { month: 'Mei', year: 2025, high: 3435.016, low: 3120.65 },
            { month: 'Jun', year: 2025, high: 3451.251, low: 3247.921 },
            { month: 'Jul', year: 2025, high: 3438.98, low: 3268.034 },
            { month: 'Agu', year: 2025, high: 3453.924, low: 3281.566 },
            { month: 'Sep', year: 2025, high: 3871.7, low: 3437.028 },
            { month: 'Okt', year: 2025, high: 4380.074, low: 3819.335 }
        ];

        let monthlyChart = null;
        const periodSelect = document.getElementById('periodSelect');
        const dataTableBody = document.getElementById('dataTableBody');


        function filterData(period) {
            if (period === 'all') {
                return {
                    tableData: rawData,
                    chartData: priceData
                };
            }
            
            const year = parseInt(period);
            
            return {
                tableData: rawData.filter(d => d.monthYear.endsWith(year.toString())),
                chartData: priceData.filter(d => d.year === year)
            };
        }


        function renderTable(data) {
            dataTableBody.innerHTML = ''; // Bersihkan data lama

            data.forEach(item => {
                const row = dataTableBody.insertRow();
                row.className = 'hover:bg-gray-700 transition-colors';
                
                // Fungsi pembantu untuk menentukan warna tren
                const getTrendColor = (trend) => {
                    if (trend.toLowerCase().includes('uptrend')) return 'text-green-400 font-bold';
                    if (trend.toLowerCase().includes('downtrend')) return 'text-red-400 font-bold';
                    return 'text-yellow-400';
                };

                row.innerHTML = `
                    <td class="px-4 py-2 whitespace-nowrap text-gray-300">${item.monthYear}</td>
                    <td class="px-4 py-2 whitespace-nowrap ${getTrendColor(item.trend)}">${item.trend}</td>
                    <td class="px-4 py-2 text-gray-400">${item.desc}</td>
                    <td class="px-4 py-2 text-gray-400">${item.factor}</td>
                `;
            });
        }


        function renderChart(data) {
            const ctx = document.getElementById('priceChart').getContext('2d');
            
            const labels = data.map(d => `${d.month} ${d.year}`);
            const avgPrices = data.map(d => (d.high + d.low) / 2);

            // Hancurkan chart lama jika ada
            if (monthlyChart) {
                monthlyChart.destroy();
            }

            monthlyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Harga Rata-Rata Bulanan (XAUUSD)',
                        data: avgPrices,
                        fill: true,
                        backgroundColor: 'rgba(255, 193, 7, 0.2)', // Kuning Emas
                        borderColor: '#FFC107',
                        borderWidth: 2,
                        tension: 0.4,
                        pointRadius: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: { display: true, text: 'Harga (USD)', color: '#9CA3AF' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#D1D5DB' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#D1D5DB', maxRotation: 45, minRotation: 0 }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            labels: { color: '#D1D5DB' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(31, 41, 55, 0.9)',
                            titleColor: '#FFC107',
                            bodyColor: '#D1D5DB',
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed.y);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }


        // Muat data awal & Event Listener untuk fitur Data Historis
        document.addEventListener('DOMContentLoaded', () => {
            
            const loadData = () => {
                const selectedPeriod = periodSelect.value;
                const { tableData, chartData } = filterData(selectedPeriod);
                
                renderTable(tableData);
                renderChart(chartData);
            };

            // Muat data awal (Keseluruhan)
            loadData();

            // Tambahkan event listener untuk mengganti periode
            periodSelect.addEventListener('change', loadData);
        });

    </script>
</body>
</html>
